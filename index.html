<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Cpath fill='%237c3aed' d='M16 2L4 14l3 3 9-9 9 9 3-3L16 2zm0 10l-6 6v12h4v-8h4v8h4V18l-6-6z'/%3E%3C/svg%3E" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tritan - AI Workflow Engine</title>

  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --bg-0: #09090b;
      --bg-1: #18181b;
      --bg-2: #27272a;
      --bg-3: #3f3f46;
      --accent: #7c3aed;
      --accent-light: #a78bfa;
      --green: #22c55e;
      --yellow: #eab308;
      --red: #ef4444;
      --blue: #3b82f6;
      --pink: #ec4899;
      --orange: #f97316;
      --teal: #14b8a6;
      --purple: #8b5cf6;
      --text: #fafafa;
      --text-2: #a1a1aa;
      --text-3: #71717a;
      --border: #27272a;
    }

    html,
    body,
    #root {
      height: 100%;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-0);
      color: var(--text);
      font-size: 13px;
    }

    .app {
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 48px;
      padding: 0 16px;
      background: var(--bg-1);
      border-bottom: 1px solid var(--border);
    }

    .header-left,
    .header-right {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      font-size: 15px;
    }

    .logo-box {
      width: 24px;
      height: 24px;
      background: var(--accent);
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .logo-box svg {
      width: 14px;
      height: 14px;
      fill: white;
    }

    .input {
      background: var(--bg-2);
      border: 1px solid var(--border);
      padding: 6px 10px;
      color: var(--text);
      border-radius: 6px;
      width: 160px;
      font-family: inherit;
      font-size: 13px;
    }

    .input:focus {
      outline: none;
      border-color: var(--accent);
    }

    .btn {
      display: flex;
      align-items: center;
      gap: 5px;
      height: 30px;
      padding: 0 12px;
      font-size: 12px;
      font-weight: 500;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: var(--bg-2);
      color: var(--text);
      cursor: pointer;
      font-family: inherit;
    }

    .btn:hover {
      background: var(--bg-3);
    }

    .btn-icon {
      width: 30px;
      padding: 0;
      justify-content: center;
    }

    .btn-primary {
      background: var(--accent);
      border-color: var(--accent);
    }

    .btn-primary:hover {
      background: var(--accent-light);
    }

    .sep {
      width: 1px;
      height: 20px;
      background: var(--border);
    }

    .layout {
      display: flex;
      flex: 1;
      overflow: hidden;
    }

    .sidebar {
      width: 180px;
      background: var(--bg-1);
      border-right: 1px solid var(--border);
      padding: 12px;
      overflow-y: auto;
    }

    .sidebar-title {
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      color: var(--text-3);
      margin: 8px 0;
      letter-spacing: 0.5px;
    }

    .node-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px;
      border-radius: 6px;
      cursor: grab;
      margin-bottom: 2px;
    }

    .node-item:hover {
      background: var(--bg-2);
    }

    .node-dot {
      width: 8px;
      height: 8px;
      border-radius: 2px;
    }

    .node-text {
      font-size: 13px;
    }

    .canvas {
      flex: 1;
      position: relative;
      overflow: hidden;
      background: var(--bg-0);
    }

    .canvas.panning {
      cursor: grabbing;
    }

    .viewport {
      position: absolute;
      transform-origin: 0 0;
    }

    .grid {
      position: absolute;
      width: 6000px;
      height: 6000px;
      left: -3000px;
      top: -3000px;
      background-size: 20px 20px;
      background-image: radial-gradient(circle, #333 1px, transparent 1px);
    }

    .nodes {
      position: absolute;
    }

    .node {
      position: absolute;
      min-width: 180px;
      background: var(--bg-1);
      border: 1px solid var(--border);
      border-radius: 10px;
      cursor: grab;
    }

    .node:hover {
      border-color: var(--bg-3);
    }

    .node.selected {
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(124, 58, 237, 0.2);
    }

    .node.dragging {
      opacity: 0.8;
      z-index: 100;
    }

    .node-bar {
      height: 3px;
      background: var(--node-color);
      border-radius: 10px 10px 0 0;
    }

    .node-head {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border-bottom: 1px solid var(--border);
    }

    .node-icon {
      width: 22px;
      height: 22px;
      background: var(--node-color);
      border-radius: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .node-icon svg {
      width: 12px;
      height: 12px;
      fill: white;
      stroke: white;
      stroke-width: 2;
    }

    .node-title {
      font-size: 13px;
      font-weight: 600;
    }

    .node-body {
      padding: 10px 12px;
    }

    .field {
      margin-bottom: 8px;
    }

    .field:last-child {
      margin-bottom: 0;
    }

    .field-label {
      display: block;
      font-size: 10px;
      font-weight: 500;
      color: var(--text-3);
      text-transform: uppercase;
      margin-bottom: 4px;
    }

    .field-input,
    .field-select,
    .field-textarea {
      width: 100%;
      padding: 6px 8px;
      font-size: 12px;
      color: var(--text);
      background: var(--bg-2);
      border: 1px solid var(--border);
      border-radius: 4px;
      font-family: inherit;
    }

    .field-input:focus,
    .field-select:focus,
    .field-textarea:focus {
      outline: none;
      border-color: var(--accent);
    }

    .field-textarea {
      resize: none;
      min-height: 50px;
    }

    .handle {
      position: absolute;
      width: 12px;
      height: 12px;
      background: var(--bg-2);
      border: 2px solid var(--text-3);
      border-radius: 50%;
      cursor: crosshair;
      z-index: 10;
      transition: transform 0.1s;
    }

    .handle:hover {
      transform: scale(1.3);
      background: var(--accent);
      border-color: var(--accent);
    }

    .handle-in {
      left: -6px;
      top: 50%;
      margin-top: -6px;
      border-color: var(--teal);
    }

    .handle-in:hover {
      background: var(--teal);
      border-color: var(--teal);
    }

    .handle-out {
      right: -6px;
      top: 50%;
      margin-top: -6px;
      border-color: var(--accent);
    }

    .handle-out:hover {
      background: var(--accent);
      border-color: var(--accent);
    }

    .edges {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: visible;
    }

    .edge {
      fill: none;
      stroke: var(--accent);
      stroke-width: 2;
      opacity: 0.6;
      pointer-events: stroke;
      cursor: pointer;
    }

    .edge:hover {
      opacity: 1;
      stroke-width: 3;
    }

    .edge-temp {
      stroke: var(--teal);
      stroke-dasharray: 5;
      opacity: 0.7;
    }

    .controls {
      position: absolute;
      bottom: 12px;
      left: 12px;
      display: flex;
      background: var(--bg-1);
      border: 1px solid var(--border);
      border-radius: 6px;
      overflow: hidden;
    }

    .ctrl-btn {
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: none;
      border: none;
      color: var(--text-2);
      cursor: pointer;
      font-size: 14px;
    }

    .ctrl-btn:hover {
      background: var(--bg-2);
      color: var(--text);
    }

    .ctrl-lbl {
      padding: 0 8px;
      font-size: 11px;
      color: var(--text-3);
      display: flex;
      align-items: center;
    }

    .empty {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      pointer-events: none;
    }

    .empty-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-2);
    }

    .empty-desc {
      font-size: 13px;
      color: var(--text-3);
      margin-top: 4px;
    }

    .panel {
      width: 240px;
      background: var(--bg-1);
      border-left: 1px solid var(--border);
      display: flex;
      flex-direction: column;
    }

    .panel-head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px;
      border-bottom: 1px solid var(--border);
    }

    .panel-title {
      font-size: 13px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .status {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 11px;
    }

    .status-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--green);
    }

    .status-dot.err {
      background: var(--red);
    }

    .panel-body {
      flex: 1;
      overflow-y: auto;
      padding: 12px;
    }

    .panel-label {
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      color: var(--text-3);
      margin-bottom: 8px;
    }

    .msg {
      display: flex;
      gap: 8px;
      padding: 8px;
      background: var(--bg-2);
      border-radius: 6px;
      margin-bottom: 6px;
      border-left: 2px solid var(--yellow);
      font-size: 12px;
      color: var(--text-2);
    }

    .msg.err {
      border-color: var(--red);
    }

    .msg.ok {
      border-color: var(--green);
    }

    .stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      margin-top: 12px;
    }

    .stat {
      background: var(--bg-2);
      border-radius: 6px;
      padding: 12px;
      text-align: center;
    }

    .stat-num {
      font-size: 22px;
      font-weight: 600;
      color: var(--accent);
    }

    .stat-lbl {
      font-size: 10px;
      color: var(--text-3);
      text-transform: uppercase;
    }
  </style>
</head>

<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useRef, useEffect, useLayoutEffect } = React;

    const NODES = {
      trigger: { label: 'Trigger', color: 'var(--green)', cat: 'flow' },
      action: { label: 'Action', color: 'var(--blue)', cat: 'flow' },
      condition: { label: 'Condition', color: 'var(--yellow)', cat: 'flow' },
      loop: { label: 'Loop', color: 'var(--purple)', cat: 'flow' },
      llm: { label: 'LLM', color: 'var(--pink)', cat: 'ai' },
      http: { label: 'HTTP', color: 'var(--blue)', cat: 'data' },
      code: { label: 'Code', color: 'var(--teal)', cat: 'data' },
      transform: { label: 'Transform', color: 'var(--orange)', cat: 'data' },
    };

    const MODELS = {
      groq: ['llama-3.3-70b-versatile', 'llama-3.1-8b-instant'],
      openrouter: ['anthropic/claude-3.5-sonnet', 'openai/gpt-4o'],
      gemini: ['gemini-2.0-flash-exp', 'gemini-1.5-pro']
    };

    function App() {
      const [name, setName] = useState('Untitled');
      const [nodes, setNodes] = useState([]);
      const [edges, setEdges] = useState([]);
      const [selected, setSelected] = useState(null);

      const onDrag = (e, type) => { e.dataTransfer.setData('nodeType', type); };

      return (
        <div className="app">
          <header className="header">
            <div className="header-left">
              <div className="logo">
                <div className="logo-box"><svg viewBox="0 0 24 24"><path d="M12 2L4 10l2 2 6-6 6 6 2-2-8-8z" /></svg></div>
                <span>Tritan</span>
              </div>
              <div className="sep" />
              <input className="input" value={name} onChange={e => setName(e.target.value)} />
            </div>
            <div className="header-right">
              <button className="btn btn-icon" onClick={() => { setNodes([]); setEdges([]); }} title="Clear">
                <svg viewBox="0 0 24 24" width="14" height="14" stroke="currentColor" strokeWidth="2" fill="none"><path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" /></svg>
              </button>
              <div className="sep" />
              <button className="btn btn-primary" onClick={() => alert(nodes.length ? 'Workflow ready!' : 'Add nodes first')}>
                <svg viewBox="0 0 24 24" width="12" height="12" fill="currentColor"><path d="M8 5v14l11-7z" /></svg>
                Run
              </button>
            </div>
          </header>

          <div className="layout">
            <aside className="sidebar">
              <div className="sidebar-title">Control</div>
              {['trigger', 'action', 'condition', 'loop'].map(t => (
                <div key={t} className="node-item" draggable onDragStart={e => onDrag(e, t)}>
                  <div className="node-dot" style={{ background: NODES[t].color }} />
                  <span className="node-text">{NODES[t].label}</span>
                </div>
              ))}
              <div className="sidebar-title">AI</div>
              {['llm'].map(t => (
                <div key={t} className="node-item" draggable onDragStart={e => onDrag(e, t)}>
                  <div className="node-dot" style={{ background: NODES[t].color }} />
                  <span className="node-text">{NODES[t].label}</span>
                </div>
              ))}
              <div className="sidebar-title">Data</div>
              {['http', 'code', 'transform'].map(t => (
                <div key={t} className="node-item" draggable onDragStart={e => onDrag(e, t)}>
                  <div className="node-dot" style={{ background: NODES[t].color }} />
                  <span className="node-text">{NODES[t].label}</span>
                </div>
              ))}
            </aside>

            <Canvas nodes={nodes} setNodes={setNodes} edges={edges} setEdges={setEdges} selected={selected} setSelected={setSelected} />

            <aside className="panel">
              <div className="panel-head">
                <div className="panel-title">
                  <svg viewBox="0 0 24 24" width="14" height="14" stroke="currentColor" strokeWidth="2" fill="none"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" /></svg>
                  Guardian
                </div>
                <div className="status">
                  <div className={`status-dot ${nodes.some(n => n.type === 'trigger') ? '' : 'err'}`} />
                  <span>{nodes.some(n => n.type === 'trigger') ? 'Valid' : 'Issues'}</span>
                </div>
              </div>
              <div className="panel-body">
                <div className="panel-label">Validation</div>
                {!nodes.length && <div className="msg">Add nodes to start</div>}
                {nodes.length > 0 && !nodes.some(n => n.type === 'trigger') && <div className="msg err">Missing trigger node</div>}
                {nodes.filter(n => n.type === 'llm' && !n.data.prompt).map(n => <div key={n.id} className="msg">{n.data.label} needs prompt</div>)}
                {nodes.some(n => n.type === 'trigger') && <div className="msg ok">Ready to run</div>}
                <div className="stats">
                  <div className="stat"><div className="stat-num">{nodes.length}</div><div className="stat-lbl">Nodes</div></div>
                  <div className="stat"><div className="stat-num">{edges.length}</div><div className="stat-lbl">Edges</div></div>
                </div>
              </div>
            </aside>
          </div>
        </div>
      );
    }

    function Canvas({ nodes, setNodes, edges, setEdges, selected, setSelected }) {
      const ref = useRef();
      const nodeRefs = useRef({});

      const [zoom, setZoom] = useState(1);
      const [pan, setPan] = useState({ x: 0, y: 0 });
      const [panning, setPanning] = useState(false);
      const [panStart, setPanStart] = useState({ x: 0, y: 0 });
      const [dragging, setDragging] = useState(null);
      const [dragOff, setDragOff] = useState({ x: 0, y: 0 });
      const [connecting, setConnecting] = useState(null);
      const [tempEdge, setTempEdge] = useState(null);
      const [tick, setTick] = useState(0);

      // Force re-render to update edge positions after nodes mount
      useLayoutEffect(() => { setTick(t => t + 1); }, [nodes, edges]);

      useEffect(() => {
        const el = ref.current;
        const onWheel = e => { e.preventDefault(); setZoom(z => Math.max(0.25, Math.min(2, z + (e.deltaY > 0 ? -0.1 : 0.1)))); };
        el?.addEventListener('wheel', onWheel, { passive: false });
        return () => el?.removeEventListener('wheel', onWheel);
      }, []);

      const toCanvas = (cx, cy) => {
        const r = ref.current.getBoundingClientRect();
        return { x: (cx - r.left - pan.x) / zoom, y: (cy - r.top - pan.y) / zoom };
      };

      const getHandlePos = (nodeId, side) => {
        const node = nodes.find(n => n.id === nodeId);
        if (!node) return null;
        // Use fixed dimensions based on node type (more reliable than refs)
        const hasBody = ['llm', 'http', 'code', 'condition'].includes(node.type);
        const w = 180;
        const h = hasBody ? 160 : 50; // LLM/HTTP/Code have body, others don't
        return { x: node.x + (side === 'out' ? w : 0), y: node.y + h / 2 };
      };

      const onDrop = e => {
        e.preventDefault();
        const type = e.dataTransfer.getData('nodeType');
        if (!type || !NODES[type]) return;
        const p = toCanvas(e.clientX, e.clientY);
        setNodes(prev => [...prev, {
          id: `n${Date.now()}`,
          type,
          x: p.x - 90,
          y: p.y - 30,
          data: { label: NODES[type].label, provider: 'groq', model: 'llama-3.3-70b-versatile', prompt: '', config: {} }
        }]);
      };

      const onCanvasDown = e => {
        if (e.button === 1 || e.button === 2) {
          e.preventDefault();
          setPanning(true);
          setPanStart({ x: e.clientX - pan.x, y: e.clientY - pan.y });
        }
      };

      const onNodeDown = (e, node) => {
        if (e.target.closest('.handle') || ['SELECT', 'INPUT', 'TEXTAREA'].includes(e.target.tagName)) return;
        e.stopPropagation();
        setSelected(node.id);
        setDragging(node.id);
        const p = toCanvas(e.clientX, e.clientY);
        setDragOff({ x: p.x - node.x, y: p.y - node.y });
      };

      const onMouseMove = e => {
        if (panning) { setPan({ x: e.clientX - panStart.x, y: e.clientY - panStart.y }); return; }
        if (dragging) {
          const p = toCanvas(e.clientX, e.clientY);
          setNodes(prev => prev.map(n => n.id === dragging ? { ...n, x: p.x - dragOff.x, y: p.y - dragOff.y } : n));
        }
        if (connecting) {
          const start = getHandlePos(connecting, 'out');
          const mouse = toCanvas(e.clientX, e.clientY);
          if (start) setTempEdge({ x1: start.x, y1: start.y, x2: mouse.x, y2: mouse.y });
        }
      };

      const onMouseUp = () => { setPanning(false); setDragging(null); setConnecting(null); setTempEdge(null); };

      const outDown = (e, id) => { e.stopPropagation(); setConnecting(id); };

      const inUp = (e, id) => {
        e.stopPropagation();
        if (connecting && connecting !== id && !edges.some(c => c.from === connecting && c.to === id)) {
          setEdges(prev => [...prev, { id: `e${Date.now()}`, from: connecting, to: id }]);
        }
        setConnecting(null);
        setTempEdge(null);
      };

      const upd = (id, k, v) => setNodes(prev => prev.map(n => n.id === id ? { ...n, data: { ...n.data, [k]: v } } : n));

      return (
        <div className={`canvas ${panning ? 'panning' : ''}`} ref={ref}
          onDrop={onDrop} onDragOver={e => e.preventDefault()}
          onMouseDown={onCanvasDown} onMouseMove={onMouseMove} onMouseUp={onMouseUp} onMouseLeave={onMouseUp}
          onContextMenu={e => e.preventDefault()} onClick={() => setSelected(null)}>

          <div className="viewport" style={{ transform: `translate(${pan.x}px,${pan.y}px) scale(${zoom})` }}>
            <div className="grid" />

            <div className="nodes">
              {nodes.map(n => (
                <div key={n.id} ref={el => { if (el) nodeRefs.current[n.id] = el; }}
                  className={`node ${selected === n.id ? 'selected' : ''} ${dragging === n.id ? 'dragging' : ''}`}
                  style={{ left: n.x, top: n.y, '--node-color': NODES[n.type].color }}
                  onMouseDown={e => onNodeDown(e, n)}>
                  <div className="node-bar" />
                  {n.type !== 'trigger' && <div className="handle handle-in" onMouseUp={e => inUp(e, n.id)} />}
                  <div className="handle handle-out" onMouseDown={e => outDown(e, n.id)} />
                  <div className="node-head">
                    <div className="node-icon"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="4" /></svg></div>
                    <span className="node-title">{n.data.label}</span>
                  </div>
                  {n.type === 'llm' && (
                    <div className="node-body">
                      <div className="field">
                        <label className="field-label">Provider</label>
                        <select className="field-select" value={n.data.provider} onChange={e => upd(n.id, 'provider', e.target.value)}>
                          {Object.keys(MODELS).map(p => <option key={p}>{p}</option>)}
                        </select>
                      </div>
                      <div className="field">
                        <label className="field-label">Model</label>
                        <select className="field-select" value={n.data.model} onChange={e => upd(n.id, 'model', e.target.value)}>
                          {(MODELS[n.data.provider] || []).map(m => <option key={m}>{m}</option>)}
                        </select>
                      </div>
                      <div className="field">
                        <label className="field-label">Prompt</label>
                        <textarea className="field-textarea" value={n.data.prompt} onChange={e => upd(n.id, 'prompt', e.target.value)} placeholder="Enter prompt..." />
                      </div>
                    </div>
                  )}
                  {n.type === 'http' && (
                    <div className="node-body">
                      <div className="field">
                        <label className="field-label">Method</label>
                        <select className="field-select" value={n.data.config.method || 'GET'} onChange={e => upd(n.id, 'config', { ...n.data.config, method: e.target.value })}>
                          <option>GET</option><option>POST</option><option>PUT</option><option>DELETE</option>
                        </select>
                      </div>
                      <div className="field">
                        <label className="field-label">URL</label>
                        <input className="field-input" value={n.data.config.url || ''} onChange={e => upd(n.id, 'config', { ...n.data.config, url: e.target.value })} placeholder="https://..." />
                      </div>
                    </div>
                  )}
                  {n.type === 'code' && (
                    <div className="node-body">
                      <div className="field">
                        <label className="field-label">Script</label>
                        <textarea className="field-textarea" value={n.data.config.code || ''} onChange={e => upd(n.id, 'config', { ...n.data.config, code: e.target.value })} placeholder="return data" />
                      </div>
                    </div>
                  )}
                  {n.type === 'condition' && (
                    <div className="node-body">
                      <div className="field">
                        <label className="field-label">Condition</label>
                        <input className="field-input" value={n.data.config.condition || ''} onChange={e => upd(n.id, 'config', { ...n.data.config, condition: e.target.value })} placeholder="value > 10" />
                      </div>
                    </div>
                  )}
                </div>
              ))}
            </div>

            <svg className="edges" key={tick} style={{ position: 'absolute', top: 0, left: 0, width: 5000, height: 5000, pointerEvents: 'none', overflow: 'visible' }}>
              {edges.map(edge => {
                const s = getHandlePos(edge.from, 'out');
                const t = getHandlePos(edge.to, 'in');
                if (!s || !t) return null;
                const mx = (s.x + t.x) / 2;
                return <path key={edge.id} className="edge" stroke="#7c3aed" strokeWidth="2" fill="none" d={`M${s.x},${s.y} C${mx},${s.y} ${mx},${t.y} ${t.x},${t.y}`} onClick={() => setEdges(prev => prev.filter(e => e.id !== edge.id))} />;
              })}
              {tempEdge && <path className="edge edge-temp" stroke="#14b8a6" strokeWidth="2" strokeDasharray="5" fill="none" d={`M${tempEdge.x1},${tempEdge.y1} L${tempEdge.x2},${tempEdge.y2}`} />}
            </svg>
          </div>

          {!nodes.length && (
            <div className="empty">
              <div className="empty-title">Start building</div>
              <div className="empty-desc">Drag nodes from the sidebar</div>
            </div>
          )}

          <div className="controls">
            <button className="ctrl-btn" onClick={() => setZoom(z => Math.min(2, z + 0.25))}>+</button>
            <span className="ctrl-lbl">{Math.round(zoom * 100)}%</span>
            <button className="ctrl-btn" onClick={() => setZoom(z => Math.max(0.25, z - 0.25))}>-</button>
            <button className="ctrl-btn" onClick={() => { setZoom(1); setPan({ x: 0, y: 0 }); }}>o</button>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>

</html>